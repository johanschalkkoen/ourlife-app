<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OurLife Dashboard</title>
  <link rel="icon" type="image/png" href="https://placehold.co/32x32/808080/FFFFFF?text=OL" alt="OurLife Logo">
  <script src="https://cdn.jsdelivr.net/npm/react@18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@babel/standalone@7.20.6/babel.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios@1.4.0/dist/axios.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      background: #1e293b;
      min-height: 100vh;
      font-family: 'Inter', sans-serif;
      color: #f1f5f9;
    }
    .card {
      background: rgba(255,255,255,0.05);
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      border: 1px solid rgba(255,255,255,0.05);
      backdrop-filter: blur(8px);
    }
    .sticky-header { position: sticky; top: 0; z-index: 50; background: #1e293b; border-bottom: 1px solid rgba(255,255,255,0.1); }
    .nav-links { display: flex; gap: 0.5rem; }
    @media (max-width: 768px) {
      .nav-links { display: none; }
      .nav-links.open { display: flex; flex-direction: column; position: absolute; top: 64px; left: 0; right: 0; background: #1e293b; border-bottom: 1px solid rgba(255,255,255,0.1); z-index: 40; }
      .hamburger-menu { display: block; }
    }
    .hamburger-menu { display: none; }
    input, select, textarea { color: #111 !important; }
    ::placeholder { color: #94a3b8 !important; }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useEffect } = React;

    // Utility function to capitalize first letter
    const capitalizeFirstLetter = (string) => {
      if (!string) return '';
      return string.charAt(0).toUpperCase() + string.slice(1);
    };

    // --- Admin Panel ---
    const AdminPanel = ({ user, setPage }) => {
      const [users, setUsers] = useState([]);
      const [loading, setLoading] = useState(true);
      const [error, setError] = useState('');
      useEffect(() => {
        setLoading(true);
        setError('');
        axios.get('/api/users', { timeout: 5000 })
          .then(response => {
            if (Array.isArray(response.data)) {
              setUsers(response.data);
            } else {
              setError('Invalid user list format.');
            }
          })
          .catch(() => setError('Failed to load users.'))
          .finally(() => setLoading(false));
      }, []);
      return (
        <main className="p-4 sm:p-6 max-w-2xl mx-auto">
          <section className="card p-8">
            <div className="flex justify-between items-center mb-6">
              <h2 className="text-2xl font-semibold text-white">Admin Panel</h2>
              <button
                onClick={() => setPage('menu')}
                className="px-3 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600"
              >
                Back to Menu
              </button>
            </div>
            <h3 className="text-lg font-semibold mb-4 text-white">All Users</h3>
            {loading ? (
              <p className="text-gray-400">Loading users...</p>
            ) : error ? (
              <p className="text-red-400">{error}</p>
            ) : (
              <ul className="list-disc pl-6">
                {users.length
                  ? users.map(u => (
                      <li key={u.username || u} className="text-white">
                        {capitalizeFirstLetter(u.username || u)}
                      </li>
                    ))
                  : <li className="text-gray-400">No users found.</li>}
              </ul>
            )}
          </section>
        </main>
      );
    };

    // --- Navigation Component ---
    const Navigation = ({ user, setPage, onLogout }) => {
      const [isMenuOpen, setIsMenuOpen] = useState(false);
      const toggleMenu = () => setIsMenuOpen(!isMenuOpen);
      const handleNavClick = (page) => {
        setPage(page);
        setIsMenuOpen(false);
      };
      return (
        <nav className="sticky-header p-4 flex items-center justify-between">
          <div className="flex items-center gap-3">
            <img src="https://placehold.co/32x32/808080/FFFFFF?text=OL" alt="OurLife Logo" className="w-8 h-8" />
            <h1 className="text-xl font-semibold text-white">OurLife Dashboard</h1>
          </div>
          <button
            className="hamburger-menu md:hidden text-white focus:outline-none"
            onClick={toggleMenu}
            tabIndex={0}
            aria-label="Toggle navigation menu"
          >
            <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M4 6h16M4 12h16m-7 6h7" />
            </svg>
          </button>
          <div className={`nav-links flex-col md:flex-row md:flex space-x-0 md:space-x-2 ${isMenuOpen ? 'open' : ''}`}>
            <button onClick={() => handleNavClick('menu')} className="px-3 py-2 text-white hover:bg-teal-500 rounded-lg w-full text-left md:w-auto">Home</button>
            <button onClick={() => handleNavClick('financial')} className="px-3 py-2 text-white hover:bg-teal-500 rounded-lg w-full text-left md:w-auto">Finances</button>
            <button onClick={() => handleNavClick('calendar')} className="px-3 py-2 text-white hover:bg-teal-500 rounded-lg w-full text-left md:w-auto">Calendar</button>
            <button onClick={() => handleNavClick('profileSettings')} className="px-3 py-2 text-white hover:bg-teal-500 rounded-lg w-full text-left md:w-auto">Profile</button>
            <button onClick={() => handleNavClick('budgetCalculator')} className="px-3 py-2 text-white hover:bg-teal-500 rounded-lg w-full text-left md:w-auto">Budget</button>
            <button onClick={() => handleNavClick('about')} className="px-3 py-2 text-white hover:bg-teal-500 rounded-lg w-full text-left md:w-auto">About</button>
            <button onClick={() => handleNavClick('support')} className="px-3 py-2 text-white hover:bg-teal-500 rounded-lg w-full text-left md:w-auto">Support</button>
            <button onClick={() => handleNavClick('contact')} className="px-3 py-2 text-white hover:bg-teal-500 rounded-lg w-full text-left md:w-auto">Contact</button>
            {user && user.isAdmin && (
              <button onClick={() => handleNavClick('admin')}
                className="px-3 py-2 text-white hover:bg-teal-500 rounded-lg w-full text-left md:w-auto">
                Admin
              </button>
            )}
            <button onClick={onLogout} className="px-3 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 w-full text-left md:w-auto">Sign Out</button>
          </div>
        </nav>
      );
    };

    // --- Stub page components (use your real ones!) ---
    const Menu = ({ user, setPage }) => (
      <main className="p-4 sm:p-6 max-w-4xl mx-auto">
        <section className="card p-8">
          <h1 className="text-2xl font-semibold text-white mb-6 text-center flex items-center justify-center gap-3">
            <span>Welcome, {capitalizeFirstLetter(user.username)}!</span>
          </h1>
          <div className="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 mb-6">
            <button onClick={() => setPage('financial')} className="p-4 bg-teal-500 text-white rounded-lg hover:bg-teal-600 text-center">Finances</button>
            <button onClick={() => setPage('calendar')} className="p-4 bg-teal-500 text-white rounded-lg hover:bg-teal-600 text-center">Calendar</button>
            <button onClick={() => setPage('profileSettings')} className="p-4 bg-teal-500 text-white rounded-lg hover:bg-teal-600 text-center">Profile</button>
            <button onClick={() => setPage('budgetCalculator')} className="p-4 bg-teal-500 text-white rounded-lg hover:bg-teal-600 text-center">Budget</button>
            <button onClick={() => setPage('about')} className="p-4 bg-teal-500 text-white rounded-lg hover:bg-teal-600 text-center">About</button>
            <button onClick={() => setPage('support')} className="p-4 bg-teal-500 text-white rounded-lg hover:bg-teal-600 text-center">Support</button>
            <button onClick={() => setPage('contact')} className="p-4 bg-teal-500 text-white rounded-lg hover:bg-teal-600 text-center sm:col-start-2 md:col-start-auto">Contact</button>
          </div>
        </section>
      </main>
    );
    // You should replace the below with your real components!
    const Financial = () => <div className="card p-8 m-6">Finances Page</div>;
    const Calendar = () => <div className="card p-8 m-6">Calendar Page</div>;
    const ProfileSettings = () => <div className="card p-8 m-6">Profile Page</div>;
    const BudgetCalculator = () => <div className="card p-8 m-6">Budget Page</div>;
    const About = () => <div className="card p-8 m-6">About Page</div>;
    const Support = () => <div className="card p-8 m-6">Support Page</div>;
    const Contact = () => <div className="card p-8 m-6">Contact Page</div>;

    // --- Main App ---
    const App = () => {
      // Replace with real authentication logic
      const [user, setUser] = useState({ username: "admin", isAdmin: true });
      const [page, setPage] = useState("menu");
      const onLogout = () => { setUser(null); setPage("menu"); };

      if (!user) {
        return <div className="card p-8 m-6 text-center">Please login to use OurLife!</div>;
      }
      return (
        <>
          <Navigation user={user} setPage={setPage} onLogout={onLogout} />
          <div>
            {page === "menu" && <Menu user={user} setPage={setPage} />}
            {page === "financial" && <Financial />}
            {page === "calendar" && <Calendar />}
            {page === "profileSettings" && <ProfileSettings />}
            {page === "budgetCalculator" && <BudgetCalculator />}
            {page === "about" && <About />}
            {page === "support" && <Support />}
            {page === "contact" && <Contact />}
            {page === "admin" && user?.isAdmin && (
              <AdminPanel user={user} setPage={setPage} />
            )}
          </div>
        </>
      );
    };

    ReactDOM.render(<App />, document.getElementById("root"));
  </script>
</body>
</html>
